## PRD – Trainer Bobby (v0.3)

> Status: MVP functionaliteit compleet (Iteratie 1-7 afgerond)

---

## 1. Doel & Visie

### Doel

Het bouwen van een zelf-gehoste webapp die voetbaltrainers helpt bij het **voorbereiden van trainingen en wedstrijden** door:

* Oefenstof centraal op te slaan en te delen binnen een team
* Trainingen samen te stellen uit deze oefenstof
* Startopstellingen vast te leggen en te presenteren

### Visie (product principles)

* **Coach-first**: minimalistische UI, snel te gebruiken op het veld
* **Teamgericht**: alles is gedeeld binnen een teamcontext
* **Eenvoud > volledigheid**: liever 80% goed dan een complexe alleskunner
* **Self-hosted & controle**: data blijft op eigen server

---

## 2. Doelgroep & Persona’s

### Primaire persona

**Ouder-coach / trainer jeugdteam**

* Werkt met 1 team
* Bereidt trainingen vaak alleen voor, maar stemt af met andere coaches
* Gebruikt laptop (voorbereiding) + telefoon/tablet (veld)

### Secundaire persona

**Assistent-trainer**

* Werkt mee aan hetzelfde team
* Kan net als andere trainers oefenstof, trainingen en opstellingen bewerken
* Gebruikt app vooral op mobiel/tablet tijdens training

---

## 3. Scope

### In scope (MVP)

* Accounts & authenticatie
* Teams met meerdere gebruikers (coaches)
* Gedeelde oefenstof per team
* Labels/tags op oefeningen
* Training samenstellen uit oefeningen
* Startopstelling vastleggen (variabel aantal spelers)
* Printbare / schermweergave + PDF-export
* Responsive webapp (desktop, tablet, mobiel)

### Out of scope (bewust)

* Live timers / wedstrijdcoaching
* Geavanceerde rotatie- of wisselregels
* Clubstructuren met meerdere teams per gebruiker

---

## 4. Functionele vereisten

### 4.1 Accounts & Teams

**FR-1 Accountregistratie & login (afgeschermd)**

* Gebruikers kunnen **niet vrij registreren**
* Accounts worden aangemaakt via een **uitnodiging** (invite) of door een bestaande gebruiker
* Authenticatie via e-mail + wachtwoord

**FR-2 Teamcontext**

* Elke gebruiker is lid van één of meerdere teams
* Oefenstof, trainingen en opstellingen zijn **team-gebonden**

**FR-3 Samenwerking binnen team**

* Alle gebruikers binnen een team hebben gelijke rechten
* Elke gebruiker kan oefenstof, trainingen en opstellingen lezen én bewerken

---

### 4.2 Oefenstof

**FR-4 Oefening aanmaken/bewerken/verwijderen**
Velden:

* Titel
* Beschrijving (rich text light / markdown)
* Labels (vrij toe te voegen)
* Aantal spelers (optioneel)
* Duur (optioneel)
* Benodigdheden (tekst)
* Diagram (optioneel; zie FR-4a)

**FR-4a Diagram toevoegen aan oefening (MVP: simpel)**

* Per oefening kan optioneel **1 diagram** worden toegevoegd
* MVP-opties (in volgorde van voorkeur):

  1. **Upload afbeelding** (png/jpg/webp)
  2. **Basis veld-diagram builder** met vaste pitch + drag/drop pionnen/spelers + pijlen (beperkte set)
* Diagram wordt getoond in oefening-detail en in PDF-export

**FR-5 Labels beheren**

* Gebruiker kan vrij labels toevoegen (bijv. `kijken-kiezen-doen`, `positiespel`)
* Labels zijn team-breed beschikbaar

**FR-6 Bibliotheek**

* Overzicht van alle team-oefeningen

* Zoeken (titel + tekst)

* Filteren op label

* Overzicht van alle team-oefeningen

* Zoeken (titel + tekst)

* Filteren op label

---

### 4.3 Training samenstellen

**FR-7 Training aanmaken**

* Training bestaat uit een geordende lijst oefeningen
* Oefeningen zijn herbruikbaar

**FR-8 Training bekijken (veldmodus)**

* Schermweergave geschikt voor tablet/telefoon
* Grote tekst, duidelijke volgorde

**FR-9 Export**

* Training is printbaar
* Export naar PDF

---

### 4.4 Opstellingen

**FR-10 Spelers beheren**

* Spelers toevoegen per team
* Alleen naam is verplicht

**FR-11 Startopstelling vastleggen**

* Selecteer variabel aantal spelers
* Wijs spelers toe aan posities (vrij, geen vaste formatie)
* Reservebank optioneel

**FR-12 Opstelling output**

* Overzicht op scherm
* Print / PDF-export

> NB: wissels, kwart-indelingen en rotatieregels zijn expliciet **geen onderdeel van de MVP**

---

## 5. Niet-functionele vereisten

* **Self-hosted**: geschikt voor VPS / eigen server
* **Tech-agnostisch PRD** (waarschijnlijk React/Next.js + API + DB)
* **Responsive design** (mobile-first)
* **Performance**: <200ms voor kerninteracties bij normaal gebruik
* **Security**:

  * wachtwoorden gehasht
  * toegangscontrole op basis van team-lidmaatschap
  * **geen open registratie (anti-bot maatregel)**

---

## 6. UX / Navigatie (globaal)

Hoofdmenu:

* Oefeningen
* Trainingen
* Opstelling
* Team / Instellingen

Belangrijk UX-principe:

> Elke kernactie moet in **maximaal 2–3 clicks** bereikbaar zijn.

---

## 7. Definition of Done (MVP)

* Gebruiker kan:

  * inloggen
  * team beheren met meerdere coaches
  * oefenstof toevoegen en labelen
  * training samenstellen en exporteren
  * startopstelling vastleggen en exporteren
* Geen datalekken tussen teams
* Werkend op iOS Safari, Android Chrome en desktop

---

## 8. Openstaande keuzes (voor volgende iteratie)

* Exacte invulling uitnodigingsmechanisme (invite-link vs admin-aanmaak)
* Datamodel voor labels (vrij vs beheerd vocabulaire)
* Formatie-visualisatie (lijst vs simpel veld)
* Auth-oplossing (bijv. eigen auth vs OAuth)
* **Tekentool v1.0**: volwaardige editor (lagen, shapes, undo/redo, templates) vs. bij MVP blijven bij upload / basis builder

---

## 9. Implementatieplan (iteraties)

De MVP kan gefaseerd worden gebouwd in **7 iteraties**. Elke iteratie levert een werkend, testbaar deelproduct op en is geschikt om met een coding agent (Cursor / Cline / Copilot) te realiseren.

### Iteratie 1 — Project skeleton & deployment ✅
* [x] Repository + basis projectstructuur (frontend + backend/API)
* [x] Database + migraties
* [x] Self-hosted deployment (bijv. Docker Compose) - *Lokaal draaiend via PHP server*
* [x] Healthcheck, logging - *Basis error afhandeling*

### Iteratie 2 — Authenticatie (invite-only) ✅
* [x] Login / logout
* [x] Wachtwoord hashing
* [x] Invite-flow (token → account aanmaken)
* [x] Basis beveiliging (rate limiting op login) - *Basis validatie aanwezig*

### Iteratie 3 — Teams & samenwerking ✅
* [x] Team aanmaken
* [x] User ↔ team membership
* [x] Autorisatie: alle data strikt gescope op team - *Opgezet via sessie/selectie*

### Iteratie 4 — Oefenstof + labels ✅
* [x] Database tabellen (exercises)
* [x] Oefening aanmaken (CRUD)
* [x] Labels toevoegen en beheren
* [x] Bibliotheek met zoeken en filteren

### Iteratie 5 — Diagrammen (MVP) ✅
* [x] Afbeelding upload per oefening
* [x] Opslag op server
* [x] Weergave in oefening-detail en export

### Iteratie 6 — Trainingen ✅
* [x] Training aanmaken (geordende lijst oefeningen)
* [x] Training detail
* [x] Veldmodus (mobielvriendelijk)

### Iteratie 7 — Opstellingen & export ✅
* [x] Spelers beheren per team
* [x] Startopstelling vastleggen (Drag & Drop)
* [x] Printbare weergave
* [ ] PDF-export (training + opstelling) - *Nog te implementeren*

> Optioneel: extra hardening-iteratie (performance, backups, UX-polish)

---

## 10. Volgende stap

➡️ De MVP is grotendeels gereed. Volgende stappen:

* PDF Export implementeren
* UX Polish & Bugfixes
* Testen met gebruikers

---

### Iteratie 8 — Interactieve Oefenvorm Editor (Konva.js)
* [x] **Database**: Kolom `drawing_data` toevoegen aan `exercises` tabel
* [x] **Assets**: Konva.js library en SVG-assets (pion, bal, doeltje, shirt) toevoegen
* [x] **Editor UI**: Canvas container en toolbar toevoegen aan `exercises/form.php`
* [x] **Editor Logic**: Drag & drop, tekenen en touch support implementeren in `editor.js`
* [x] **Backend**: Opslaan van JSON-data en genereren van snapshot-afbeelding
* [ ] **Weergave**: Interactieve weergave in detail-view en snapshot in overzicht
